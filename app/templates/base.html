<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>{{ t["app_name"] if t else "humAI" }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- AdminLTE & Bootstrap CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <style>
   body.login-page {  background-color: #0ab139 !important; font-family: 'Segoe UI', sans-serif;}
    .main-sidebar, .main-header { background-color: #28a745 !important;  }
     @media (max-width: 768px) {

    .table-wrapper {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    table.disease-table {
      min-width: 900px; /* murag landscape */
    }

    table.disease-table th,
    table.disease-table td {
      font-size: 14px;
      padding: 8px;
    }

    table.disease-table img {
      width: 80px;
      height: auto;
    }

  }
  </style>

</head>

<body class="{% if request.endpoint == 'auth.login' or request.endpoint == 'auth.register_user' %}login-page{% else %}hold-transition sidebar-mini layout-fixed{% endif %}">
<div class="wrapper">
  {% if not (request.endpoint == 'auth.login' or request.endpoint == 'auth.register_user') %}

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-success navbar-light">

    <!-- LEFT NAV -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" style="color:white;"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item"><a href="{{ url_for('lang.set_language', lang_code='en') }}" 
        class="nav-link" style="color:white;">EN</a></li>
      <li class="nav-item"><a href="{{ url_for('lang.set_language', lang_code='fil') }}" 
        class="nav-link" style="color:white;">FIL</a></li>
      <li class="nav-item"><a href="{{ url_for('lang.set_language', lang_code='ceb') }}" 
        class="nav-link" style="color:white;">CEB</a></li>
    </ul>

  <ul class="navbar-nav ml-auto">
  {% if current_user.is_authenticated %}
  <li class="nav-item">
    <a class="nav-link" href="#" data-toggle="modal" data-target="#logoutModal" style="color:white !important;">
      <i class="fas fa-sign-out-alt mr-1"></i> Logout </a></li>
  {% else %}

  <li class="nav-item">
    <a href="{{ url_for('auth.login') }}" class="nav-link" style="color:white !important;">
      <i class="fas fa-sign-in-alt mr-1"></i> Login</a> </li>
  {% endif %}
</ul>
</nav>

  <!-- Sidebar -->
  <aside class="main-sidebar sidebar-dark-success elevation-4">

   <!-- BRAND LOGO -->
<a href="{{ url_for('dashboard.dashboard') if current_user.is_authenticated else '#' }}" class="brand-link">
  <img src="{{ url_for('static', filename='logo.png') }}" 
       alt="Logo" class="brand-image img-circle elevation-3" style="opacity:.9; width:40px; height:40px;">
  <span class="brand-text font-weight-bold" style="color:white;">humAI</span>
</a>

<div class="sidebar">
  <nav class="mt-2">
    <ul class="nav nav-pills nav-sidebar flex-column">
      {% if (current_user.is_authenticated and current_user.role in ['Admin', 'Expert', 'User']) or not current_user.is_authenticated %}
      <li class="nav-item"> 
        <a href="{{ url_for('dashboard.dashboard') }}" class="nav-link" style="color:white;">
          <i class="nav-icon fas fa-tachometer-alt"></i> 
          <p>{{ t["dashboard"] }}</p></a></li>
      {% endif %}

      <li class="nav-item">
        <a href="{{ url_for('detect.detect') }}" class="nav-link" style="color:white;">
          <i class="nav-icon fas fa-dna"></i> 
          <p>{{ t["detection"] }}</p></a></li>

      {% if current_user.is_authenticated and current_user.role in ['Admin', 'Expert'] %}
      <li class="nav-item">
        <a href="{{ url_for('disease.list_diseases') }}" class="nav-link" style="color:white;">
          <i class="nav-icon fas fa-notes-medical"></i>
          <p>{{ t["diseases"] }}</p></a></li>
      {% endif %}

      {% if current_user.is_authenticated and current_user.role == 'Admin' %}
      <li class="nav-item">
        <a href="{{ url_for('admin.manage_users') }}" class="nav-link" style="color:white;">
          <i class="nav-icon fas fa-users-cog"></i>
          <p>{{ t["users"] }}</p></a></li>
         {% endif %}
         
      {% if current_user.is_authenticated and current_user.role in ['Admin', 'Expert'] %}
      <li class="nav-item">
       <a href="{{ url_for('detect.logs') }}" class="nav-link" style="color:white;">
         <i class="nav-icon fas fa-history"></i>
         <p>{{ t["detection_logs"] }}</p></a></li>
         {% endif %}
         </ul>
      </nav>
    </div>
  </aside>
  {% endif %}

  <!-- CONTENT WRAPPER -->
  <div class="content-wrapper">
    {% block content %}{% endblock %}
  </div>
</div>

<!-- LOGOUT CONFIRMATION MODAL -->
<div class="modal fade" id="logoutModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius: 12px; overflow: hidden;">

      <!-- HEADER -->
      <div class="modal-header" style="background-color:#2f855a;">
        <h5 class="modal-title" style="color:white; font-weight:bold;"> Confirm Logout </h5>
        <button type="button" class="close text-white" data-dismiss="modal">&times;</button></div>

      <!-- BODY -->
      <div class="modal-body text-center" style="padding:25px;">
        <p style="font-size:16px; color:#155724; font-weight:500;"> Are you sure you want to logout? </p></div>

      <!-- FOOTER -->
      <div class="modal-footer" style="border-top:1px solid #c3e6cb;">
        <button class="btn btn-secondary" data-dismiss="modal" 
                style="border-radius:6px; font-weight:bold;"> No </button>

        <a href="{{ url_for('auth.logout') }}"
           class="btn"
           style="background-color:#2f855a; color:white; font-weight:bold; border-radius:6px;"> Yes </a></div>
    </div>
  </div>
</div>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
</body>
</html>
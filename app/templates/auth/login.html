{% extends 'base.html' %}
{% block content %}
<style>
/* Base */
html, body {
  margin: 0;
  padding: 0;
  background: #28a745;
}

header, nav, .navbar, .main-header, .main-sidebar, .language-switcher {
  display: none !important;
}

.center-wrapper {
  min-height: 100svh; /* mobile-safe viewport */
  display: flex;
  justify-content: center;
  align-items: center;
  padding-top: env(safe-area-inset-top);
}

/* GLASS CARD */
.login-box {
  width: 360px;
  padding: 30px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.12);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
  text-align: center;
  border: 1px solid rgba(255,255,255,0.25);
}

/* Logo text */
.login-logo {
  font-size: 34px;
  font-weight: bold;
  color: white;
  margin-bottom: 20px;
  letter-spacing: 2px;
}

/* Fields */
.form-control {
  height: 44px;
  border-radius: 10px;
  border: none;
  margin-bottom: 15px;
  padding-left: 12px;
}

.form-control:focus {
  box-shadow: 0 0 10px rgba(255,255,255,0.5);
}

/* Button */
.btn-success {
  width: 50%;
  height: 44px;
  background: #038447;
  border: none;
  border-radius: 10px;
  font-weight: bold;
  transition: 0.3s;
}
.btn-success:hover {
  background: #0ad06f;
  transform: translateY(-2px);
}

/* Links */
a {
  color: white;
  opacity: 0.9;
}
a:hover { opacity: 1; }

/* Remove AdminLTE BG */
.content-wrapper, .wrapper, .content, .content-header {
  background: none !important;
}

/* Flash message */
.flash-message {
  margin-bottom: 15px;
  padding: 10px;
  border-radius: 8px;
  font-weight: bold;
}
.flash-success { background-color: #28a745; color: white; }
.flash-danger { background-color: #dc3545; color: white; }
</style>

<div class="center-wrapper">
  <div class="login-box">

    <!-- LOGIN SECTION -->
    <div id="login-section">
      <div class="login-logo"><b>LOGIN</b></div>

      <div class="text-center mb-2">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" width="80">
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, msg in messages %}
            <div class="flash-message flash-{{ category }}">{{ msg }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="POST">
        <input type="text" name="username" class="form-control" placeholder="Username" value="" autocomplete="off" required>
        <input type="password" name="password" class="form-control" placeholder="Password" value="" autocomplete="new-password" required>
        <button type="submit" class="btn btn-success mb-2">Login</button>

        <div class="mt-2" id="detect-button">
          <a href="{{ url_for('dashboard.dashboard') }}" class="btn btn-success" style="width:100%;">Detect</a>
        </div>

        <div class="mt-2">
          <a href="#" id="need-account-link">Create an account?</a>
        </div>
      </form>
    </div>

    <!-- REGISTER SECTION -->
    <div id="register-section" style="display:none;">
      <div class="login-logo"><b>REGISTER</b></div>

      {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <!-- Plain text, no background color -->
      <div style="color: rgb(8, 8, 8); font-weight: bold; margin-top:10px;">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<br>
      <form method="POST" action="{{ url_for('auth.register_user') }}">
        <input type="text" name="username" class="form-control" placeholder="Username" value="" autocomplete="off" required>
        <input type="password" name="password" class="form-control" placeholder="Password" value="" autocomplete="new-password" required>

        <button type="submit" class="btn btn-success">Register</button>

        <div class="mt-3">
          <a href="#" id="back-to-login">Back to Login</a>
        </div>
      </form>
    </div>

  </div>
</div>

<script>
// Switch between login and register
document.getElementById("need-account-link").addEventListener("click", function(e) {
    e.preventDefault();
    document.getElementById("login-section").style.display = "none";
    document.getElementById("register-section").style.display = "block";
});

document.getElementById("back-to-login").addEventListener("click", function(e) {
    e.preventDefault();
    document.getElementById("register-section").style.display = "none";
    document.getElementById("login-section").style.display = "block";
});
</script>

{% endblock %}